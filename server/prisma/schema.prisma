generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

model User {
  id           String     @id @default(uuid())
  name         String?
  email        String     @unique
  passwordHash String
  // Contratos que o usuário criou
  contracts    Contract[] @relation("OwnedContracts")
  // Contratos atribuídos a esse usuário
  assigned     Contract[] @relation("AssignedContracts")
  createdAt    DateTime   @default(now())
}

model Contract {
  id          String         @id @default(uuid())
  title       String
  clientName  String
  value       Float?
  description String?
  imageUrl    String?
  status      ContractStatus @default(NEGOTIATION)

  // Dono do contrato
  ownerId String
  owner   User @relation("OwnedContracts", fields: [ownerId], references: [id])

  // Usuário designado (opcional)
  assignedTo String?
  assignee   User? @relation("AssignedContracts", fields: [assignedTo], references: [id])

  createdAt  DateTime       @default(now())
  updatedAt  DateTime       @updatedAt
}

enum ContractStatus {
  NEGOTIATION
  SIGNING
  ACTIVE
  COMPLETED
}
